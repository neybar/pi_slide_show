$spacing: .5em;

body {
        background-color: black;
}
div.shelf {
    overflow: hidden;
}
div#top_row, div#bottom_row {
    position: relative;
    overflow: hidden;
}
div#bottom_row {
    padding-top: $spacing;
}
.photo {
    position: relative;
    height: 100%;
}
.photo:last-child .img_box {
    margin-right: 0;
}
.img_box {
    margin-right: $spacing;
    overflow: hidden;
    position: relative;
    left: 0;
    height: 100%;

    img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center center;
    }
}
.img_box + .img_box {
    margin-top: $spacing;
}
.portrait {
    max-width: 113.8%; /* Some sort of sane default, but will override */
}

div#photo_store {
    display: none;
}

div.album_name {
    position: absolute;
    color: white;
    mix-blend-mode: difference;
    bottom: 1em;
    text-align: center;
    font-size: 3em;
    width: 100%;
    text-shadow:
        1px 1px 2px rgba(0, 0, 0, 0.3),
        -1px -1px 2px rgba(0, 0, 0, 0.3),
        1px -1px 2px rgba(0, 0, 0, 0.3),
        -1px 1px 2px rgba(0, 0, 0, 0.3);
}

// Panorama container - fills vertical space with horizontal overflow
.panorama-container {
    height: 100%;

    .img_box {
        width: calc(100% - #{$spacing});
        height: 100%;
        margin-right: $spacing;
        overflow: hidden;
    }

    img {
        height: 100%;
        width: auto;
        max-width: none;
        max-height: 100%;
        object-fit: contain;
        object-position: left center;
    }
}

// Panorama overflow - panning animation for images wider than container
.panorama-overflow {
    img {
        animation: panorama-pan var(--pan-duration, 30s) ease-in-out infinite alternate;
    }
}

// Ensure height propagates through Pure CSS grid for panoramas
div.shelf .pure-g {
    height: 100%;
}

// Override Pure CSS inline-block to allow flex stretch
div.shelf .photo.panorama-container {
    display: flex;
    height: 100%;
}

// Keyframes for panorama panning animation
// Uses CSS custom property --pan-distance set by JavaScript
@keyframes panorama-pan {
    0% {
        transform: translateX(0);
    }
    100% {
        transform: translateX(var(--pan-distance, 0));
    }
}

// =============================================================================
// Individual Photo Swap Animations
// =============================================================================
// Slide-in animations with heavy ball bounce effect
// Physics: Photo slides in, then bounces 2-3 times with decreasing amplitude
// Gravity direction matches the slide direction (e.g., drop from top = bounces down)
// Duration: 1200ms for smooth rendering and visible bounce effect

$slide-duration: 1200ms;

// Bounce amplitudes (decreasing like a heavy ball)
$bounce-1: 10%;  // First bounce - largest
$bounce-2: 4%;   // Second bounce - medium
$bounce-3: 1.5%; // Third bounce - small settling

// --- Slide-in Animations (with heavy ball bounce) ---

// Slide in from top (drops down, bounces down then settles)
@keyframes slide-in-from-top {
    0% {
        transform: translateY(-100%);
        opacity: 0;
    }
    5% {
        opacity: 1;
    }
    35% {
        transform: translateY(0); // Arrives at final position
    }
    50% {
        transform: translateY($bounce-1); // First bounce - overshoots down
    }
    62% {
        transform: translateY(0); // Rebounds to position
    }
    74% {
        transform: translateY($bounce-2); // Second bounce - smaller
    }
    84% {
        transform: translateY(0); // Rebounds again
    }
    92% {
        transform: translateY($bounce-3); // Third tiny bounce
    }
    100% {
        transform: translateY(0); // Settled
        opacity: 1;
    }
}

// Slide in from bottom (rises up, bounces up then settles)
@keyframes slide-in-from-bottom {
    0% {
        transform: translateY(100%);
        opacity: 0;
    }
    5% {
        opacity: 1;
    }
    35% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-$bounce-1); // First bounce - overshoots up
    }
    62% {
        transform: translateY(0);
    }
    74% {
        transform: translateY(-$bounce-2); // Second bounce
    }
    84% {
        transform: translateY(0);
    }
    92% {
        transform: translateY(-$bounce-3); // Third tiny bounce
    }
    100% {
        transform: translateY(0);
        opacity: 1;
    }
}

// Slide in from left (slides right, bounces right then settles)
@keyframes slide-in-from-left {
    0% {
        transform: translateX(-100%);
        opacity: 0;
    }
    5% {
        opacity: 1;
    }
    35% {
        transform: translateX(0);
    }
    50% {
        transform: translateX($bounce-1); // First bounce - overshoots right
    }
    62% {
        transform: translateX(0);
    }
    74% {
        transform: translateX($bounce-2); // Second bounce
    }
    84% {
        transform: translateX(0);
    }
    92% {
        transform: translateX($bounce-3); // Third tiny bounce
    }
    100% {
        transform: translateX(0);
        opacity: 1;
    }
}

// Slide in from right (slides left, bounces left then settles)
@keyframes slide-in-from-right {
    0% {
        transform: translateX(100%);
        opacity: 0;
    }
    5% {
        opacity: 1;
    }
    35% {
        transform: translateX(0);
    }
    50% {
        transform: translateX(-$bounce-1); // First bounce - overshoots left
    }
    62% {
        transform: translateX(0);
    }
    74% {
        transform: translateX(-$bounce-2); // Second bounce
    }
    84% {
        transform: translateX(0);
    }
    92% {
        transform: translateX(-$bounce-3); // Third tiny bounce
    }
    100% {
        transform: translateX(0);
        opacity: 1;
    }
}

// --- Slide-out Animations (no bounce, simple exit) ---

@keyframes slide-out-to-top {
    0% {
        transform: translateY(0);
        opacity: 1;
    }
    100% {
        transform: translateY(-100%);
        opacity: 0;
    }
}

@keyframes slide-out-to-bottom {
    0% {
        transform: translateY(0);
        opacity: 1;
    }
    100% {
        transform: translateY(100%);
        opacity: 0;
    }
}

@keyframes slide-out-to-left {
    0% {
        transform: translateX(0);
        opacity: 1;
    }
    100% {
        transform: translateX(-100%);
        opacity: 0;
    }
}

@keyframes slide-out-to-right {
    0% {
        transform: translateX(0);
        opacity: 1;
    }
    100% {
        transform: translateX(100%);
        opacity: 0;
    }
}

// --- Animation Classes ---

// Slide-in classes (with bounce)
.slide-in-from-top {
    animation: slide-in-from-top $slide-duration ease-out forwards;
}

.slide-in-from-bottom {
    animation: slide-in-from-bottom $slide-duration ease-out forwards;
}

.slide-in-from-left {
    animation: slide-in-from-left $slide-duration ease-out forwards;
}

.slide-in-from-right {
    animation: slide-in-from-right $slide-duration ease-out forwards;
}

// Slide-out classes (no bounce)
.slide-out-to-top {
    animation: slide-out-to-top $slide-duration ease-in forwards;
}

.slide-out-to-bottom {
    animation: slide-out-to-bottom $slide-duration ease-in forwards;
}

.slide-out-to-left {
    animation: slide-out-to-left $slide-duration ease-in forwards;
}

.slide-out-to-right {
    animation: slide-out-to-right $slide-duration ease-in forwards;
}

// Ensure .photo elements can contain animated children
.photo {
    overflow: hidden;
}
